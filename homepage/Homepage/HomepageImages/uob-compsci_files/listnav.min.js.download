(function(e){e.fn.listnav=function(t){var i=e.extend({},e.fn.listnav.defaults,t),l=["_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","-"],n=!1,s="";return s=null!==document.ontouchstart?"click":"touchend click",i.prefixes=e.map(i.prefixes,function(e){return e.toLowerCase()}),this.each(function(){function t(){if(C.append(f()),m=e(".ln-letters",C).slice(0,1),i.showCounts&&(N=e(".ln-letter-count",C).slice(0,1)),o(),c(),h(),i.flagDisabled&&r(),i.includeAll||e(".all",m).remove(),i.includeNums||e("._",m).remove(),i.includeOther||e(".-",m).remove(),i.removeDisabled&&e(".ln-disabled",m).remove(),e(":last",m).addClass("ln-last"),e.cookie&&null!==i.cookieName){var t=e.cookie(i.cookieName);null!==t&&"undefined"!=typeof t&&(i.initLetter=t)}if(""!==i.initLetter)n=!0,e("."+i.initLetter.toLowerCase(),m).slice(0,1).trigger("click");else if(i.initHidden)u(),H.children().addClass("listNavHide"),H.children(".ln-init-hidden").removeClass("listNavHide");else if(i.includeAll)e(".all",m).addClass("ln-selected");else for(var s=i.includeNums?0:1;s<l.length;s++)if(k[l[s]]>0){n=!0,e("."+l[s],m).slice(0,1).trigger("click");break}}function a(){var t=N.outerHeight();N.css({top:e("a:first",C).slice(0,1).position().top-t})}function o(){var t,l,n="",s=i.prefixes.length>0,a=i.filterSelector.length>0;e(H).children().each(function(){if(l=e(this),t=a?e.trim(l.find(i.filterSelector).text()).toLowerCase():e.trim(l.text()).toLowerCase(),""!==t){if(s){var o=e.map(i.prefixes,function(e){return e.indexOf(" ")<=0?e+" ":e}),r=e.grep(o,function(e){return 0===t.indexOf(e)});if(r.length>0){var c=t.toLowerCase().split(r[0])[1];return n=null!==c?e.trim(c).charAt(0):t.charAt(0),void d(n,l,!0)}}n=t.charAt(0),d(n,l)}})}function d(e,t,i){/\W/.test(e)&&(e="-"),isNaN(e)||(e="_"),t.addClass("ln-"+e),void 0===k[e]&&(k[e]=0),k[e]++,i||S++}function r(){for(var t=0;t<l.length;t++)void 0===k[l[t]]&&e("."+l[t],m).addClass("ln-disabled")}function c(){H.append('<li class="ln-no-match listNavHide">'+i.noMatchText+"</li>")}function u(){H.append('<li class="ln-init-hidden listNavHide">'+i.initHiddenText+"</li>")}function v(t){return e(t).hasClass("all")?b=i.dontCount?S-H.find(i.dontCount).length:S:(t=".ln-"+e(t).attr("class").split(" ")[0],w=i.dontCount?H.find(t).not(i.dontCount).length:H.find(t).length,void 0!==w?w:0)}function h(){i.showCounts&&(C.mouseover(function(){a()}),e(".ln-letters a",C).mouseover(function(){p=e(this).position().left,g=e(this).outerWidth()+"px",w=v(this),N.css({left:p,width:g}).text(w).addClass("letterCountShow").removeClass("listNavHide")}).mouseout(function(){N.addClass("listNavHide").removeClass("letterCountShow")})),e("a",m).on(s,function(t){t.preventDefault();var l=e(this),s=l.attr("class").split(" ")[0],a=H.children(".ln-no-match");if(i.initHidden&&H.children(".ln-init-hidden").remove(),A!==s){if(e("a.ln-selected",m).removeClass("ln-selected"),"all"===s)H.children().addClass("listNavShow").removeClass("listNavHide"),a.addClass("listNavHide").removeClass("listNavShow"),L=!0;else{L?(H.children().addClass("listNavHide").removeClass("listNavShow"),L=!1):""!==A&&H.children(".ln-"+A).addClass("listNavHide").removeClass("listNavShow");var o=v(this);o>0?(H.children(".ln-"+s).addClass("listNavShow").removeClass("listNavHide"),a.addClass("listNavHide").removeClass("listNavShow")):a.addClass("listNavShow").removeClass("listNavHide")}A=s,e.cookie&&null!==i.cookieName&&e.cookie(i.cookieName,s,{expires:999}),l.addClass("ln-selected"),l.blur(),n||null===i.onClick?n=!1:i.onClick(s)}})}function f(){for(var e=[],t=1;t<l.length;t++)0===e.length&&e.push('<a class="all" href="#">'+i.allText+'</a><a class="_" href="#">0-9</a>'),e.push('<a class="'+l[t]+'" href="#">'+("-"===l[t]?"...":l[t].toUpperCase())+"</a>");return'<div class="ln-letters">'+e.join("")+"</div>"+(i.showCounts?'<div class="ln-letter-count listNavHide">0</div>':"")}var C,m,N,p,g,w,x=this.id,H=e(this),k={},S=0,b=0,L=!0,A="";e("#"+x+"-nav").length||e('<div id="'+x+'-nav" class="listNav"/>').insertBefore(H),C=e("#"+x+"-nav"),t()})},e.fn.listnav.defaults={initHidden:!1,initHiddenText:"Tap a letter above to view matching items",initLetter:"",includeAll:!0,allText:"All",includeOther:!1,includeNums:!0,flagDisabled:!0,removeDisabled:!1,noMatchText:"No matching entries",showCounts:!0,dontCount:"",cookieName:null,onClick:null,prefixes:[],filterSelector:""}})(jQuery);